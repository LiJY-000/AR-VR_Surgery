---
title: "AR_taste"
author: "Juyuan Li"
date: "2023-11-09"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
library(ggfortify)
library(emmeans)
library(gridExtra)
library(knitr)
```

# How Taste Perception is Influenced by Augmented Reality

## Hypothesis

The Null Hypothesis:

There will be **no significant difference** in taste perception when changing the
environment using augmented reality goggles


## Purpose: 

The primary goals of this analysis is to determine whether the changes of the environment hve statistical significant effect on each kinds of taste perception feedback from the patients, reflecting if the taste perception is influenced by augmented reality.


## Methods:

This analysis is using EDA plots to show the relationship between different environment and different kinds of taste perception with all five kinds of different foods, and Two-Way Block ANOVA to analyze if the changes/difference is statistically significant.

$$Y = \mu + \alpha_k + \beta_j + \varepsilon$$

where

* $Y$ is the response variable.
* $\mu$ is the overall mean
* $\alpha_k$ is the effect of enviornment $k$ on the mean response
* $\beta_j$ is the effect of different kinds of foods $j$ on the mean response which we need to block
* $\varepsilon_{ij}$ is the underlying random noise

```{r, echo=FALSE, message=FALSE}
setwd("/Users/lijuyuan/Desktop/ARtaste")
data <- read_excel("ARtaste_data.xlsx")

# Remove rows with any missing values
data <- na.omit(data)

# Convert 'Environment' and 'Food' to factors
data$Environment <- as.factor(data$Environment)
data$Food <- as.factor(data$Food)
```


## Results:
Showing the EDA and Two-Way Block ANOVA result of each taste perception below:


## EDA_Appear

```{r, echo=FALSE, message=FALSE}
ggplot(data, aes(x=Environment,y=Appear, color=Food, group=Food))  + 
  stat_summary(fun=mean, geom="point") +
  stat_summary(fun=mean, geom="line") + 
  labs(y="Feedback of Appear") + 
  theme_bw()
```

**Analysis**

**Food 1 (Red line):** This food shows a consistent increase in appearance score from Environment 1 to Environment 2, and a slight decrease from Environment 2 to Environment 3, but the score in Environment 3 is still higher than in Environment 1. This suggests that both Environment 2 and 3 positively affect the appearance of Food 1, with Environment 2 having the most positive impact.

**Food 2 (Yellow line):** The feedback score for the appearance of Food 2 decreases consistently across the environments. The most significant drop is from Environment 2 to Environment 3, indicating that the appearance of Food 2 is perceived most negatively in Environment 3.

**Food 3 (Green line):** The feedback score for Food 3 increases from Environment 1 to Environment 2, indicating a positive effect on appearance in Environment 2. However, there is a decrease in score from Environment 2 to Environment 3, suggesting that Environment 3 negatively affects the appearance perception of Food 3.

**Food 4 (Blue line):** Food 4 shows an increase in appearance score from Environment 1 to Environment 2 and then a decrease back to a score close to that of Environment 1 in Environment 3. This suggests that Environment 2 enhances the appearance of Food 4, while Environment 3 negates that enhancement.

**Food 5 (Purple line):** The feedback score for the appearance of Food 5 increases slightly from Environment 1 to Environment 2 and then decreases significantly in Environment 3, ending lower than the score in Environment 1. This indicates that Environment 3 has a substantial negative impact on the perceived appearance of Food 5.

**Conclusion:**
The visual feedback data suggest that Environment 2 generally enhances the appearance of foods compared to Environment 1, while Environment 3 tends to be perceived as detrimental to food appearance, especially for Foods 2 and 5. 

From a statistical perspective, further analysis (Two-Way Block ANOVA) would be required


## Two-Way Block ANOVA -- Appear

```{r, echo=FALSE, message=FALSE}
data.anova <- aov(Appear ~ Food + Environment + Food:Environment, data=data)
autoplot(data.anova)
summary(data.anova)

environment.mc <- emmeans(data.anova, "Environment")
plot(contrast(environment.mc, "pairwise"))
```

**Environment:** 
With a p-value of 0.0918, the influence of the AR environment on the appearance of food is **NOT** statistically significant at the conventional α = 0.05 level. 


## EDA_Smell

```{r, echo=FALSE, message=FALSE}
ggplot(data, aes(x=Environment,y=Smell, color=Food, group=Food))  + 
  stat_summary(fun=mean, geom="point") +
  stat_summary(fun=mean, geom="line") + 
  labs(y="Feedback of Smell") + 
  theme_bw()
```

**Analysis:**

**Food 1 (Red line): **This food type shows a decrease in smell feedback scores from Environment 1 to Environment 2, followed by a slight increase into Environment 3. This suggests that Environment 2 may have attributes that negatively affect the perceived smell of Food 1, which are less pronounced or absent in Environment 3.

**Food 2 (Yellow line):** There is a consistent and notable decline in feedback scores for the smell of Food 2 as the environment changes from 1 to 3. This indicates that the smell of Food 2 is perceived less favorably in subsequent environments, with Environment 3 having the most negative impact.

**Food 3 (Green line):** The feedback scores for Food 3's smell increase from Environment 1 to Environment 2, indicating a positive effect on the smell in Environment 2. However, there's a decrease in score from Environment 2 to Environment 3, suggesting a negative impact on smell perception in Environment 3.

**Food 4 (Blue line):** The scores for Food 4 increase slightly from Environment 1 to Environment 2, and then decrease more markedly into Environment 3. This pattern suggests that while Environment 2 may slightly enhance the smell of Food 4, Environment 3 significantly diminishes it.

**Food 5 (Purple line):** The feedback for the smell of Food 5 shows a slight increase from Environment 1 to Environment 2, followed by a sharp decrease in Environment 3. This suggests that the smell of Food 5 is perceived more negatively in Environment 3 compared to the other two environments.

**Conclusion:**
The data indicates that Environment 3 generally has a negative impact on the perceived smell of the foods tested, with all food types except Food 1 showing a decrease in feedback scores in this environment. Environment 2 presents mixed effects, with some food types showing an increase in smell feedback scores and others a decrease. 


## Two-Way Block ANOVA -- Smell

```{r, echo=FALSE, message=FALSE}
data.anova <- aov(Smell ~ Food + Environment + Food:Environment, data=data)
autoplot(data.anova)
summary(data.anova)

environment.mc <- emmeans(data.anova, "Environment")
plot(contrast(environment.mc, "pairwise"))
```

**Environment:** 
The AR environment did **NOT** show a significant effect on smell (p = 0.175) at the conventional α = 0.05 level, which aligns with expectations as AR primarily alters visual and auditory stimuli, not olfactory cues.


## EDA_Mouthfeel

```{r, echo=FALSE, message=FALSE}
ggplot(data, aes(x=Environment,y=Mouthfeel, color=Food, group=Food))  + 
  stat_summary(fun=mean, geom="point") +
  stat_summary(fun=mean, geom="line") + 
  labs(y="Feedback of Mouthfeel") + 
  theme_bw()
```

**Analysis**

**Food 1 (Red line):** The feedback score for Mouthfeel of Food 1 remains relatively stable across the three environments, with a slight peak in Environment 2. This suggests that the perception of Mouthfeel for this food type is consistent regardless of the environment.

**Food 2 (Yellow line):** There is a very subtle decline in the Mouthfeel score from Environment 1 to Environment 2, followed by a steeper decline into Environment 3. This indicates that the environment might have a negative impact on the perceived Mouthfeel of Food 2, particularly when moving to Environment 3.

**Food 3 (Green line):** For Food 3, there is a noticeable increase in the Mouthfeel score from Environment 1 to Environment 2, followed by a sharp decline in Environment 3. The peak in Environment 2 suggests that this environment might enhance the Mouthfeel perception of Food 3, while Environment 3 seems to diminish it.

**Food 4 (Blue line):** This food shows an increase in Mouthfeel score from Environment 1 to Environment 2 and then a decline back to a score similar to Environment 1 in Environment 3. This could imply that Environment 2 has positive attributes that enhance Mouthfeel perception which are not present in Environment 3.

**Food 5 (Purple line):** The feedback score for Food 5 shows a steady decline across the environments, with the highest score in Environment 1 and the lowest in Environment 3. This suggests that the Mouthfeel perception for Food 5 is negatively affected by the changing environments, with the most negative impact in Environment 3.

**Conclusion**

The graph indicates that the environment has a varying impact on the perception of Mouthfeel across different food types. While some foods seem to have a consistent Mouthfeel score across environments (Food 1), others are more sensitive to changes in the environment (Foods 2, 3, 4, and 5). Specifically, Environment 2 seems to enhance Mouthfeel for some foods (3 and 4) but not others. In contrast, Environment 3 tends to have a negative impact on Mouthfeel for most food types, with the exception of Food 1, which remains relatively unaffected.

From a statistical perspective, further analysis (Two-Way Block ANOVA) would be required


## Two-Way Block ANOVA -- Mouthfeel

```{r, echo=FALSE, message=FALSE}
data.anova <- aov(Mouthfeel ~ Food + Environment + Food:Environment, data=data)
autoplot(data.anova)
summary(data.anova)
```

**Residuals vs Fitted**

This plot is used to check the assumption of linearity and homoscedasticity (constant variance of residuals).

**Normal Q-Q**

This plot checks the assumption that the residuals are normally distributed.

**Scale-Location** (also known as Spread-Location or Standardized Residuals vs. Fitted Values)

This plot is another way to check homoscedasticity.

**Residuals vs Leverage**

This plot helps to identify influential cases (outliers) that might have an undue influence on the model's predictions.

**Conclusion**

The regression model appears to be well-specified, with the assumptions of linearity and homoscedasticity being broadly met, and the residuals approximating normality, albeit with some slight deviations. However, potential outliers or influential points identified in the Residuals vs Leverage plot should be examined to ensure they are not unduly affecting the model. Further investigation into these points, possibly including robust regression techniques or transformations, could improve the model's reliability and the validity of inference drawn from it.


**Environment: **
With a p-value of 0.00514, the influence of the AR environment on the appearance of food **IS** statistically significant at the conventional α = 0.05 level.This demonstrates that AR environments can influence the sensory perception of texture, potentially through altering visual or auditory sensory inputs, which then impacts cognitive processing. It is also necessary to perform **Conditional Multiple Comparisons** since the result is significant, we perform pairwise Tukey comparisons on the Environment types.

```{r, echo=FALSE, message=FALSE}
environment.mc <- emmeans(data.anova, "Environment")
plot(contrast(environment.mc, "pairwise"))
```

**Pairwise Comparisons:** The plot presents the estimated differences between pairs of environments. Each line represents the estimated difference between the means of two environments, with the dot denoting the point estimate of the difference and the horizontal line representing the 95% confidence interval.

**Environment1 - Environment2:**

The point estimate is near zero, indicating a very small mean difference between Environment 1 and Environment 2.
The confidence interval spans both sides of zero but is mostly on the positive side. Since the interval includes zero, it suggests that the difference is not statistically significant at the 0.05 level.

**Environment1 - Environment3:**

The point estimate is positive and further from zero compared to the Environment1 - Environment2 estimate, suggesting a larger mean difference between Environment 1 and Environment 3.
The confidence interval is entirely above zero and does not include it, indicating that the difference is statistically significant at the 0.05 level.

**Environment2 - Environment3:**

The point estimate is positive and close to the estimate for Environment1 - Environment3, indicating a similar mean difference between Environment 2 and Environment 3.
The confidence interval for this comparison is also entirely above zero, suggesting that the difference is statistically significant at the 0.05 level.

**Conclusion**

Based on the confidence intervals, we can conclude that:

There is no statistically significant difference between Environment 1 and Environment 2 (since the confidence interval includes zero).
There are statistically significant differences between Environment 1 and Environment 3, as well as between Environment 2 and Environment 3 (since their confidence intervals are entirely above zero).
These results would inform us that whatever metric is being measured is significantly different in Environment 3 compared to both Environment 1 and Environment 2, while the metrics in Environments 1 and 2 are not significantly different from each other.



## EDA_Flavor

```{r, echo=FALSE, message=FALSE}
ggplot(data, aes(x=Environment,y=Flavor, color=Food, group=Food))  + 
  stat_summary(fun=mean, geom="point") +
  stat_summary(fun=mean, geom="line") + 
  labs(y="Feedback of Flavor") + 
  theme_bw()
```

**Analysis:**

**Food 1 (Red line):** This food type exhibits an increasing trend in flavor feedback scores from Environment 1 to Environment 2, followed by a plateau from Environment 2 to Environment 3. This suggests that the flavor of Food 1 is rated more favorably in Environment 2, and this positive perception is maintained in Environment 3.

**Food 2 (Yellow line):** The feedback scores for Food 2 show a slight increase from Environment 1 to Environment 2, indicating a small improvement in flavor perception. However, there's a sharp decline in scores from Environment 2 to Environment 3, suggesting a negative impact of Environment 3 on the flavor perception of Food 2.

**Food 3 (Green line):** There is a marked increase in feedback scores for the flavor of Food 3 from Environment 1 to Environment 2, followed by a decrease back to levels close to those of Environment 1 in Environment 3. This pattern indicates that Environment 2 has a positive effect on the flavor of Food 3, which is not sustained in Environment 3.

**Food 4 (Blue line):** The feedback scores for Food 4 increase slightly from Environment 1 to Environment 2 and then decrease more significantly into Environment 3. The trend suggests that the flavor of Food 4 is perceived as better in Environment 2 compared to Environment 1, but then worsens in Environment 3.

**Food 5 (Purple line):** The feedback scores for Food 5's flavor increase modestly from Environment 1 to Environment 2, then decrease to below the initial scores in Environment 3. This suggests that Environment 3 has a detrimental effect on the perceived flavor of Food 5.

**Conclusion:**
The visual data suggests that Environment 2 tends to enhance the flavor feedback scores for most food types, whereas Environment 3 generally leads to lower scores, indicating a less favorable perception of flavor. 


## Two-Way Block ANOVA -- Flavor

```{r, echo=FALSE, message=FALSE}
data.anova <- aov(Flavor ~ Food + Environment + Food:Environment, data=data)
autoplot(data.anova)
summary(data.anova)
```

**Residuals vs Fitted**

This plot is used to check the assumption of linearity and homoscedasticity (constant variance of residuals).

**Normal Q-Q**

This plot checks the assumption that the residuals are normally distributed.

**Scale-Location** (also known as Spread-Location or Standardized Residuals vs. Fitted Values)

This plot is another way to check homoscedasticity.

**Residuals vs Leverage**

This plot helps to identify influential cases (outliers) that might have an undue influence on the model's predictions.

**Conclusion**

Based on the ANOVA results and diagnostic plots, the type of food has a significant effect on flavor perception, and the environment also influences flavor but to a lesser extent. The interaction between food type and environment does not significantly affect flavor perception. The diagnostic plots suggest some potential issues with non-linearity, heteroscedasticity, and influential points, which should be addressed to ensure the validity of the ANOVA model. 

**Environment: **
The AR environment shows a significant effect on flavor perception (p = 0.0326), indicating that visual and auditory cues provided by AR can alter the perceived taste of food. This finding is significant as it reveals the potential of AR to modify flavor perception through non-gustatory means. It is also necessary to perform **Conditional Multiple Comparisons** since the result is significant, we perform pairwise Tukey comparisons on the Environment types.

```{r, echo=FALSE, message=FALSE}
environment.mc <- emmeans(data.anova, "Environment")
plot(contrast(environment.mc, "pairwise"))
```

**Environment1 - Environment2 Contrast:**

The point estimate is close to zero, suggesting a very small mean difference between Environment 1 and Environment 2.
The confidence interval includes zero and is relatively narrow, indicating that the difference is not statistically significant, and if there is a true difference, it is likely to be small.


**Environment1 - Environment3 Contrast:**

The point estimate is positive and away from zero, indicating a mean difference between Environment 1 and Environment 3.
The confidence interval does not include zero and is wholly above it, suggesting that the difference is statistically significant at the chosen alpha level (typically 0.05).


**Environment2 - Environment3 Contrast:**

The point estimate is also positive, suggesting that Environment 2 has a higher mean on the measured metric than Environment 3.
The confidence interval for this contrast is above zero as well, which indicates that the difference is statistically significant.


**Conclusion:**
Statistically, there are significant differences in the measured metric between Environment 1 and Environment 3, and between Environment 2 and Environment 3, but not between Environment 1 and Environment 2. These findings can inform decisions about the efficacy or impact of different environmental conditions in the context of the study. 



## EDA_Prodacc

```{r, echo=FALSE, message=FALSE}
ggplot(data, aes(x=Environment,y=Prodacc, color=Food, group=Food))  + 
  stat_summary(fun=mean, geom="point") +
  stat_summary(fun=mean, geom="line") + 
  labs(y="Feedback of Prodacc") + 
  theme_bw()
```

**Analysis**

**Food 1 (Red line):** The product accuracy perception for Food 1 increases from Environment 1 to Environment 2 and then plateaus from Environment 2 to Environment 3. This indicates that Environment 2 enhances the perceived accuracy of the food's description, and the perception remains stable into Environment 3.

**Food 2 (Yellow line):** Feedback scores for Food 2 show a slight increase from Environment 1 to Environment 2, followed by a significant decrease into Environment 3. This suggests that the perceived accuracy of Food 2's description is diminished in Environment 3.

**Food 3 (Green line):** Scores for Food 3's product accuracy increase from Environment 1 to Environment 2, indicating a positive impact of Environment 2 on the perceived accuracy. However, the scores drop below the initial level in Environment 3, suggesting a negative impact of this environment on product accuracy perception.

**Food 4 (Blue line):** The feedback scores for Food 4 rise from Environment 1 to Environment 2 and then decrease into Environment 3. This pattern suggests that Environment 2 has a positive influence on the perception of product accuracy for Food 4, which is not sustained in Environment 3.

**Food 5 (Purple line):** Feedback scores for the product accuracy of Food 5 slightly increase from Environment 1 to Environment 2, then decrease substantially in Environment 3. This indicates that Environment 3 significantly impacts the perceived product accuracy negatively for Food 5.

**Conclusion:**
The visual data suggests that Environment 2 generally improves the perceived product accuracy of foods compared to Environment 1, whereas Environment 3 tends to diminish this perception. 


**Two-Way Block ANOVA -- Prodacc**

```{r, echo=FALSE, message=FALSE}
data.anova <- aov(Prodacc ~ Food + Environment + Food:Environment, data=data)
autoplot(data.anova)
summary(data.anova)

environment.mc <- emmeans(data.anova, "Environment")
plot(contrast(environment.mc, "pairwise"))
```

**Environment: **
The AR environment does not significantly affect product accuracy (p = 0.0845), although the p-value is marginally close to the threshold of significance, suggesting a potential but not definitive influence.




## Discussion

The objective of this research was to explore the impact of different environments on the perception of various food attributes, specifically appearance, smell, mouthfeel, flavor, and product accuracy, using augmented reality (AR) goggles. The statistical methodology applied was a Two-Way Block ANOVA, and the results were supplemented by diagnostic plots to assess the assumptions and fit of the model.

The environment had varying effects on different sensory attributes. It showed a significant impact on the perception of mouthfeel and flavor, indicating that AR can alter these specific sensory perceptions.
For appearance, smell, and product accuracy, the environmental effects were not statistically significant, suggesting that AR might not influence these perceptions, or the influence might be subtle and not detected by the analysis.

The diagnostic plots pointed to potential issues in the regression assumptions, such as slight non-linearity and heteroscedasticity, as well as the presence of outliers or influential points. These issues could affect the precision of the ANOVA results.

Pairwise contrasts revealed no significant difference between Environment 1(control) and Environment 2(lake). However, there were significant differences when comparing Environment 3(hospital) to both Environment 1(control) and Environment 2(lake), indicating a distinctive impact of Environment 3(hospital) on sensory perceptions.

**Conclusion:**

Overall, the study's findings illustrate the complex nature of sensory perception and its susceptibility to modification by augmented reality environments. The AR environment plays a differential role, notably affecting mouthfeel and flavor but less so other attributes.The statistical analysis showed that the environment does have a significant effect on the perception of mouthfeel and flavor. This finding supports the alternative hypothesis, indicating that AR environments can significantly alter these specific aspects of taste perception. The statistical tests for appearance, smell, and product accuracy did not yield significant results for the environmental factor. This means that for these sensory attributes, the null hypothesis cannot be rejected based on the data analyzed. There was no significant interaction effect between the type of food and the environment, which suggests that the impact of changing the environment using AR goggles on taste perception is consistent across different types of food for the attributes measured. The alternative hypothesis is supported in part, as significant differences were observed for some attributes (mouthfeel and flavor) when the environment was altered using AR goggles. For other attributes (appearance, smell, and product accuracy), the null hypothesis stands, as the study did not find significant differences when the environment was changed. The conclusion of the hypothesis is thus nuanced; while the AR environment alters the perception of certain aspects of taste, it does not significantly affect all aspects. These results underscore the selective sensitivity of taste perception attributes to environmental changes induced by AR technology.

**Recommendations to the Client:**

Leverage AR environments selectively to enhance the sensory attributes of mouthfeel and flavor in product experiences, as these are influenced by AR settings.

Be aware of the limitations in AR's influence, as it does not significantly impact the appearance, smell, or perceived product accuracy, which might require traditional methods of enhancement.

If feasible, increase the sample size in further studies to enhance the power of statistical tests, especially for attributes where significant effects were marginal or non-existent.
